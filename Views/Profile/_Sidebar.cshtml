@model CuaHangBangDiaNhac.ViewModels.ProfileViewModel
@{
    var currentAction = ViewContext.RouteData.Values["action"]?.ToString();
    var currentController = ViewContext.RouteData.Values["controller"]?.ToString();
    
    // Helper to determine active state
    string GetActive(string action, string controller = "Profile") {
        if (controller == "Order" && action == "History") {
             return (currentController == "Order" && currentAction == "History") ? "active" : "";
        }
        return (currentController == controller && currentAction == action) ? "active" : "";
    }
}

<div class="profile-nav-menu d-flex flex-column">
    <a asp-action="Index" asp-controller="Profile" class="nav-link @GetActive("Index")">
        <i class="bi bi-person-circle"></i> Thông tin tài khoản
    </a>
    
    @if (!User.IsInRole("Admin") && !User.IsInRole("Staff"))
    {
        <a asp-action="Address" asp-controller="Profile" class="nav-link @GetActive("Address")">
            <i class="bi bi-geo-alt"></i> Sổ địa chỉ
        </a>
    }

    <a asp-action="History" asp-controller="Order" class="nav-link @GetActive("History", "Order")">
        <i class="bi bi-clock-history"></i> Lịch sử đơn hàng
    </a>
    
    <a asp-action="ChangePassword" asp-controller="Profile" class="nav-link @GetActive("ChangePassword")">
        <i class="bi bi-shield-lock"></i> Đổi mật khẩu
    </a>
    
    <div class="mt-4 pt-3 border-top border-secondary">
         <form asp-controller="Account" asp-action="Logout" method="post">
            <button type="submit" class="btn w-100 text-danger fw-bold d-flex align-items-center justify-content-center" style="background: transparent; border: 1px solid #dc3545;">
                <i class="bi bi-box-arrow-right me-2"></i>Đăng xuất
            </button>
        </form>
    </div>
</div>
